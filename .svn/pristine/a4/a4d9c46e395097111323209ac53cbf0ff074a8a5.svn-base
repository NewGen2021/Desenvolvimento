{% extends 'gere/template1/base.html' %}
{% load static %}
{% load i18n %}
{% load mathfilters %}
{% load hosts %}
{% load crispy_forms_tags %}

{% block title %}{% translate "Edição de tipo espaço" %}{% endblock %}

{% block css %}

<style>
    #img_tipo {
    height: auto; 
    width: auto; 
    max-width: 600px; 
    max-height: 600px;
}
</style>
{% endblock %}

{% block content %}
<section id="tabs" class="project-tab">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                {% if nao_existe %}
                <div class="alert alert-danger alert-dismissible fade show">
                    <strong>{% translate "ERRO!" %}</strong> {% translate "Não foi possível encontrar esse tipo de espaço, volte à tela de listar espaços e selecione ou crie um válido!" %}
                </div>
                <a role="button" class="btn btn-outline-primary" href="{% host_url 'listar_espacos' host 'custom_host' domain %}?espaco=1?page=1">{% translate "← Voltar" %}</a>
                {% else %}
                
                {% if imagem %}
                <img div="imagem_layout_cima">
                {% endif %}
                <form method="post" enctype="multipart/form-data"> {% csrf_token %}
                    <!-- {# {% for field in espaco_form %}
                    <div class="fieldWrapper">
                        {# uncomment to display field errors #}
                        {# {{ field.errors }} #} 

                        {# {{ field.label_tag }} #} {{ field|as_crispy_field }}
                    </div>
                    {% endfor %} #} -->
                    <p>{{ action_link }}</p>
                    <div class="alert alert-primary alert-dismissible fade show">
                        <strong>{% translate "Nome" %} | </strong> {% translate "Coloque um nome para um tipo de espaço." %} <br> 
                        {% translate "Exemplos: Sala Compartilhada, Sala de Reunião." %} <hr>
                        {{ espaco_form.id_tipo_espaco|as_crispy_field }}
                    </div>
                    <div class="alert alert-primary alert-dismissible fade show">
                        <strong>{% translate "Descrição" %} | </strong> {% translate "Defina uma descrição para este tipo de espaço." %} <br> 
                        {% translate "Exemplo: Uma sala privada para você e seus convidados desfrutarem de privacidade e equipamentos profissionais de reunião." %} <hr>
                        {{ espaco_form.vagas|as_crispy_field }}
                    </div>
                    <div class="alert alert-primary alert-dismissible fade show">
                        <strong>{% translate "Preço" %} | </strong> {% translate "Defina um preço padrão para salas desse tipo de espaço." %} <br> 
                        <hr>
                        {{ espaco_form.preco|as_crispy_field }}
                    </div>
                    <div class="alert alert-primary alert-dismissible fade show">
                        <strong>{% translate "Compartilhado" %} | </strong> {% translate "Espaços compartilhados entram na lógica de 'vagas' por espaço, enquanto um espaço compartilhado só permite uma vaga a ser reservada em um momento." %}
                        {% translate "Espaços compartilhados permitem clientes desconhecidos alugarem aquele mesmo espaço durante um determinado período. Selecione para marcar este espaço como compartilhado." %} <br> 
                         <hr>
                        {{ espaco_form.status_espaco|as_crispy_field }}
                    </div>
                    <div class="alert alert-primary alert-dismissible fade show">
                        <div style="text-align: center;">
                            <div id="image_field"></div> <br>
                        </div>
                        <strong>{% translate "Imagem" %} | </strong> {% translate "Selecione a imagem a ser mostrada para o cliente quando ele for selecionar um tipo de espaço para escolher." %}
                        {% translate "Por padrão será usado uma imagem genérica caso não nenhuma imagem seja atribuída." %}
                        <hr>
                        {{ espaco_form.imagem|as_crispy_field }}
                    </div>
                    <div class="d-flex flex-row">
                        <a role="button" class="btn btn-outline-primary" href="{% host_url 'listar_espacos' host 'custom_host' domain %}?espaco=1?page=1">{% translate "← Voltar" %}</a>
                        <button type="submit" id="form-checkout__submit" class="btn btn-primary" style="margin-left: 2%;">{% translate "Salvar" %}</button>
                    </div>
                    
                </form>
                {% endif %}
                
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block js %}
<script>
    // alert('Chegpou1')
    // let imagem_cima = document.getElementById('imagem_layout_cima')
    // // let imagem_baixo = document.getElementById('id_imagem') // form > image field
    // // imagem_baixo.set
    // let load_image = document.createElement('img')
    // // Add media root before image link, in this case I'm adding /media/
    // load_image.setAttribute('src', "/media/{{imagem}}")
    // // load_image.setAttribute('alt', "Image Atual")
    // alert('Chegpou2')
    // imagem_cima.parentNode.insertBefore(load_image, imagem_cima.nextSibling)
    // imagem_baixo.parentNode.insertBefore(load_image, imagem_baixo.nextSibling)

    let image_field = document.getElementById('image_field') // form > image field
    // image_field.set
    let load_image = document.createElement('img')
    
    // Add media root before image link, in this case I'm adding /media/
    load_image.setAttribute('src', "/media/{{imagem}}")
    load_image.setAttribute('alt', "Image Atual")
    load_image.setAttribute('id', "img_tipo")
    image_field.parentNode.insertBefore(load_image, image_field.nextSibling)
    // image_field.childNodes[0].insertBefore(load_image, image_field.nextSibling)

    // let p = load_image.width / load_image.height
    // console.log(p);
    // load_image.height = 300
    // console.log(load_image.height);
    // load_image.width = load_image.height * p
    // console.log(load_image.width);

    // image_field = document.getElementById('imagem_layout_cima') // form > image field
    // let load_image2 = document.createElement('img')
    // // Add media root before image link, in this case I'm adding /media/
    // load_image2.setAttribute('src', "/media/{{imagem}}")
    // load_image2.setAttribute('alt', "Image Atual")
    // // // image_field.set
    // // load_image = document.createElement('img')
    // // // Add media root before image link, in this case I'm adding /media/
    // // load_image.setAttribute('src', "/media/{{imagem}}")
    // // load_image.setAttribute('alt', "Image Atual")
    // image_field.parentNode.insertBefore(load_image2, image_field.nextSibling)

//     $(function(){
//   $('#id_imagem').change(function(){
//     var input = this;
//     var url = $(this).val();
//     var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
//     if (input.files && input.files[0]&& (ext == "gif" || ext == "png" || ext == "jpeg" || ext == "jpg")) 
//      {
//     //     var reader = new FileReader();
//     alert('OI')

//     //     reader.onload = function (e) {
//     //        $('#img').attr('src', e.target.result);
//     //     }
//     //    reader.readAsDataURL(input.files[0]);
//     document.getElementById('img_tipo') = input.value;
    
//     }
//     else
//     {
//       $('#img').attr('src', '/assets/no_preview.png');
//     }
//   });

// });
document.getElementById('id_imagem').onchange = function() {
    // fire the upload here
    alert('oi');
    document.getElementById('img_tipo') = input.value;
};
 </script>
{% endblock %}